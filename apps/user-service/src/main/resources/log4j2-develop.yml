Configuration:
  status: DEBUG
  name: develop

  properties:
    property:
      - name: "app-name"
        value: "${env:APP_NAME:-user-service-app}"

  Appenders:
    # 콘솔 appender
    Console:
      name: console-appender
      target: SYSTEM_OUT
      PatternLayout:
        pattern: "[%-5level] [%X{traceId}] %d{MM-dd HH:mm:ss} [%t] %msg%n"

    # Tjahzi Loki Appender (올바른 문법)
    Loki:
      name: loki-appender
      host: localhost
      port: 3100
      PatternLayout:
        pattern: "[%-5level] [%X{traceId}] %d{MM-dd HH:mm:ss} [%t] %msg%n"
      Label:
        - name: "app"
          value: "${app-name}"           # 고정 값
        - name: "service"
          value: "user-service"          # 고정 값
        - name: "traceId"
          value: "${ctx:traceId}"           # MDC에서 가져올 값만 넣음

  Loggers:
    Root:
      level: INFO
      AppenderRef:
        - ref: console-appender

    Logger:
      # 애플리케이션 로그만 Loki로 전송 (additivity 문법 수정)
      - name: site.icebang
        additivity: false
        level: INFO
        AppenderRef:
          - ref: console-appender
          - ref: loki-appender

      # HikariCP 로그 비활성화
      - name: com.zaxxer.hikari
        level: OFF